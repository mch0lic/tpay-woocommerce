!function(){var h;function a(a){this.pubkey=a;var e=h("#card_number"),a=h("#expiry_date"),t=h("#cvc"),n=h("#c_name"),c=h("#c_email"),o=h("#tpay-cards-accept-regulations-checkbox"),r="input change blur";function l(a){a.addClass("wrong").removeClass("valid")}function d(a){a.addClass("valid").removeClass("wrong")}function i(a){var t=!1,e=h.payment.formatCardNumber(a.val()),n=["mastercard","maestro","visa"],c=h.payment.cardType(e),o=h("#info_msg_not_valid"),r=h(".tpay-card-icon"),i=h("#info_msg_not_supported");return a.val(h.payment.formatCardNumber(a.val())),r.attr("class","tpay-card-icon"),n.indexOf(c)<0&&null!==c&&1<e.length?(p(i),s(o),l(a)):-1<n.indexOf(c)&&h.payment.validateCardNumber(e)?(d(a),s(i),s(o),t=!0):e.length<4?(s(i),s(o),l(a)):(l(a),p(o),s(i)),""!==c&&r.addClass("tpay-"+c+"-icon"),t}function s(a){a.css("display","none")}function p(a){a.css("display","block")}function u(a){var t,e=!1;return a.val(h.payment.formatExpiry(a.val())),t=a.payment("cardExpiryVal"),h.payment.validateCardExpiry(t.month,t.year)?(d(a),e=!0):l(a),e}function y(a){var t=!1;return h.payment.validateCardCVC(a.val(),h.payment.cardType(e.val().replace(/\s/g,"")))?(d(a),t=!0):l(a),t}function m(a){var t=!1;return(a.val().length<3?l:(t=!0,d))(a),t}function f(a){var t=!1;return(a.formance("validate_email")?(t=!0,d):l)(a),t}function v(a){if(a.is(":checked"))return d(a),1;l(a)}h("#place_order").addClass("stop_propagation"),e.on(r,function(){i(h(this))}),a.on(r,function(){u(h(this))}),t.on(r,function(){y(h(this))}),n.on(r,function(){m(h(this))}),c.on(r,function(){f(h(this))}),o.on(r,function(){v(h(this))})}(h=jQuery)(document).ready(function(){h("form.checkout");h(document.body).on("change",'input[name="payment_method"]',function(){h("body").trigger("update_checkout")}),h("body").on("click","li.wc_payment_method > label",function(){var a=h(this);setTimeout(function(){h("html, body").animate({scrollTop:a.offset().top-180},400)},600)}),h("form").on("submit",function(a){var t=h(this).find('input[name="payment_method"]:checked').val(),e=!0;switch(console.log(t),t){case"tpaypbl":e=h("input.tpay-item:checked, select.tpay-item").length||0===h("input.tpay-item, select.tpay-item").length?(h(".pbl-error").slideUp(250),!0):(h("html, body").animate({scrollTop:h(".tpay-pbl-container").offset().top-180},300),h(".pbl-error").slideDown(250),!1);break;case"tpayblik":e=function(){var a=h("input[name=blik0]");if(a.length)return a=a[0].value,null===(a=/[0-9]{3}-[0-9]{3}/.exec(a))&&(h("html, body").animate({scrollTop:h(".tpay_blik-payment-form").offset().top-180},300),h(".blik0-error").slideDown(250)),null!==a;return!0}();break;default:e=!0}e||(a.preventDefault(),a.stopImmediatePropagation())}),h("body").on("click",'li.wc_payment_method > label:not([for="payment_method_tpaysf"])',function(){h("#carddata").val(""),h("#card_vendor").val(h.payment.cardType("")),h("#card_short_code").val(""),h("#card_number").val(""),h("#expiry_date").val(""),h("#cvc").val(""),h("#place_order").removeClass("stop_propagation"),h(".card-container .wrong").removeClass("wrong")}),h("body").on("click",".saved-cards input",function(){!0===h(this).prop("checked")?(h(".saved-cards input").not(h(this)).prop("checked",!1),h(".saved-cards input").not(h(this)).attr("name","saved-card-unchecked"),h(this).attr("name","saved-card"),h("#carddata").val(""),h("#card_vendor").val(h.payment.cardType("")),h("#card_short_code").val(""),h("#card_number").val(""),h("#expiry_date").val(""),h("#cvc").val(""),h(".card-container .wrong").removeClass("wrong"),h(".card-container").find("input").attr("readonly",!0)):(h(this).attr("name","saved-card-unchecked"),h(".card-container").find("input").attr("readonly",!1))}),h("body").on("click",'[class*="tpay_blik-payment-"]',function(){h('[class*="tpay_blik-payment-"]').removeClass("active"),h(this).addClass("active"),h(this).find('[name="blik-type"]').prop("checked","checked")}),h("body").on("keyup",'.tpay-blik0 [name="blik0"]',function(){var a=h(this).val().replace("-","").replace(/\D/g,"");h(this).val(function(a,t){var e,n,c=[];for(e=0,n=a.length;e<n;e+=t)c.push(a.substr(e,t));return c}(a,3).join("-"))}),h("body").on("click",".modal-tpay-blik .close",function(a){a.preventDefault(),h(".modal-tpay-blik-container").hide(),h(".tpay-blik-alias").click(),h(".tpay-blik-alias").addClass("active")}),h("body").on("click",".show-blik-info",function(a){a.preventDefault(),h(".modal-tpay-blik-container").css("display","flex")}),h("body").on("keyup",'.tpay-sf [name="card-number"]',function(){h(".saved-cards").find('input[type="radio"]').prop("checked",!1),new a(h(".tpay-sf").attr("data-pubkey"))}),h("body").on("click","#place_order",function(a){var t,e,n,c,o,r;""!=h(".tpay-sf").attr("data-pubkey")&&0<h(".tpay-sf").length&&h("#place_order").hasClass("stop_propagation")&&(a.preventDefault(),a.stopImmediatePropagation(),console.log("sf"),0==h(".card-container .wrong").length)&&(a=h(".tpay-sf").attr("data-pubkey"),t=h("#card_number"),e=h("#expiry_date"),n=h("#cvc"),c=t.val().replace(/\s/g,""),o=c+"|"+e.val().replace(/\s/g,"")+"|"+n.val().replace(/\s/g,"")+"|"+document.location.origin,r=new JSEncrypt,a=Base64.decode(a),r.setPublicKey(a),a=r.encrypt(o),h("#carddata").val(a),h("#card_vendor").val(h.payment.cardType(c)),h("#card_short_code").val(c.substr(-4)),function(a,t){return crypto.subtle.digest(a,new TextEncoder("utf-8").encode(t)).then(a=>Array.prototype.map.call(new Uint8Array(a),a=>("00"+a.toString(16)).slice(-2)).join(""))}("SHA-256",c).then(a=>h("#card_hash").val(a)),t.val(""),e.val(""),n.val(""),setTimeout(function(){h("#place_order").closest("form").submit()},400))})}),h("document").ready(function(){h("input[name=savedId]").first().prop("checked","checked"),h("input[name=savedId]").each(function(){h(this).click(function(){h(this).is(":checked")&&"new"!==h(this).val()&&(h("#card_form").css({opacity:1}).animate({opacity:0},500),setTimeout(function(){h("#card_form").css({display:"none"})},500))})}),h("#newCard").click(function(){h(this).is(":checked")&&h("#card_form").css({opacity:0,display:"block"}).animate({opacity:1},500)})})}();